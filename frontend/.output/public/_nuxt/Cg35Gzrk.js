import ie from"./DZPVy99e.js";import re from"./Ba6EhFot.js";import me from"./DAf1BoBp.js";import Y from"./C0LKiM39.js";import ue from"./BaAof-tj.js";import R from"./UEL7mprB.js";import q from"./CLsrxzl_.js";import ce from"./xmMfvLTi.js";import de from"./BLcYRZFp.js";import pe from"./C_s4Wp9o.js";import{_ as _e,a as fe}from"./mU5mkbUU.js";import G from"./Dw3xtoWV.js";import{u as k}from"./kVCPm6zo.js";import{s as B,u as X,f as H,r as i,o as C,g as h,w as n,b as o,a as e,h as t,i as w,d as O,t as A,j as ve,c as be,k as xe,l as U,F as ge,m as ye,n as Ce}from"./DaYTUSRu.js";import{u as E}from"./WSTKsw6M.js";import"./BvNob-ru.js";import"./EMNlt2xj.js";import"./Bk9-WN6G.js";import"./DCxbjcdO.js";import"./DqBT-TTB.js";import"./Bb0lkvXH.js";import"./5i5_fOun.js";import"./Mzrc14y1.js";import"./0r4j8XCi.js";import"./DgsDTnHf.js";import"./o9EcI8hj.js";import"./Dg-YmKK3.js";import"./CSkJlOoF.js";import"./BPlO_Ngp.js";import"./ChVfpdSc.js";import"./gKftSCzs.js";import"./BtBcd3ax.js";import"./DY1heZt9.js";import"./D3jY3syq.js";import"./D7MR76jZ.js";import"./Df8bolTu.js";import"./B-OnyGn2.js";import"./kMJDPyUJ.js";import"./DKBZx1RX.js";import"./CBeCEV4t.js";import"./DzPs5bSl.js";const he=e("div",{class:"inline-flex items-center justify-center gap-2"},[e("span",{class:"font-bold text-xl"},"Create New Customer")],-1),we={class:"flex flex-col gap-3"},$e={class:"flex flex-row gap-3"},De={class:"flex flex-1 flex-col gap-2"},Ve=e("label",{for:"firstName"},"First Name",-1),je={class:"flex flex-1 flex-col gap-2"},Ne=e("label",{for:"lastName"},"Last Name",-1),ke={class:"flex flex-row gap-3"},Se={class:"flex flex-1 flex-col gap-2"},Pe=e("label",{for:"phone"},"Phone Number",-1),Ie={class:"flex flex-1 flex-col gap-2"},Fe=e("label",{for:"email"},"Email",-1),Me={class:"flex flex-1 flex-col gap-2"},Te=e("label",{for:"projectID"},"Project",-1),Ue={__name:"CreateCustomerDialog",props:["visible"],async setup(S){let f,c;const{visible:$}=S,{addNewCustomer:x}=k(),{projectsDropdown:v}=B(E()),{getProjects:P}=E(),d=X();[f,c]=H(()=>P()),await f,c();const m=i($),g=i(""),p=i(""),r=i(""),_=i(""),b=i(""),y=i({}),D=async()=>{const I={id:Math.floor(Math.random()*Number.MAX_SAFE_INTEGER)+1,social_id:g.value,phone:p.value,first_name:r.value,last_name:_.value,display_name:`${r.value} ${_.value}`,email:b.value,project_id:parseInt(y.value.value),activated:"true",deleted:"false",created_by:1,updated_by:1,created_at:new Date().toLocaleString(),updated_at:null},s=await x(I);m.value=!1,s!=null&&s.result=="ok"?d.add({severity:"success",summary:"Success",detail:"Create New Customer Successfully!",group:"bl",life:3e3}):d.add({severity:"danger",summary:"Error",detail:"Failed to Create New Customer",group:"bl",life:3e3})};return(I,s)=>{const V=Y,z=q,j=R,F=G;return C(),h(F,{visible:t(m),"onUpdate:visible":s[6]||(s[6]=l=>w(m)?m.value=l:null),modal:"",maximizable:"",header:"Header",style:{width:"50rem"},breakpoints:{"1199px":"75vw","575px":"90vw"}},{header:n(()=>[he]),footer:n(()=>[o(j,{type:"button",label:"Cancel",text:"",severity:"secondary",onClick:s[5]||(s[5]=l=>m.value=!1)}),o(j,{type:"submit",label:"Save",onClick:D})]),default:n(()=>[e("template",we,[e("div",$e,[e("div",De,[Ve,o(V,{id:"firstName",placeholder:"First Name",modelValue:t(r),"onUpdate:modelValue":s[0]||(s[0]=l=>w(r)?r.value=l:null),modelModifiers:{trim:!0}},null,8,["modelValue"])]),e("div",je,[Ne,o(V,{id:"lastName",placeholder:"Last Name",modelValue:t(_),"onUpdate:modelValue":s[1]||(s[1]=l=>w(_)?_.value=l:null),modelModifiers:{trim:!0}},null,8,["modelValue"])])]),e("div",ke,[e("div",Se,[Pe,o(V,{id:"phone",placeholder:"+84 9698 886 660",modelValue:t(p),"onUpdate:modelValue":s[2]||(s[2]=l=>w(p)?p.value=l:null),modelModifiers:{trim:!0},integeronly:""},null,8,["modelValue"])]),e("div",Ie,[Fe,o(V,{id:"email",placeholder:"example@gmail.com",modelValue:t(b),"onUpdate:modelValue":s[3]||(s[3]=l=>w(b)?b.value=l:null),modelModifiers:{trim:!0}},null,8,["modelValue"])])]),e("div",Me,[Te,o(z,{id:"projectID",placeholder:"Select Project",modelValue:t(y).value,"onUpdate:modelValue":s[4]||(s[4]=l=>t(y).value=l),options:t(v),optionLabel:"name",optionValue:"value"},null,8,["modelValue","options"])])])]),_:1},8,["visible"])}}},Ae=e("div",{class:"inline-flex items-center justify-center gap-2"},[e("span",{class:"font-bold text-xl"},"Delete Customer?")],-1),Be=e("span",null,"You cannot undo this action!",-1),Ee={__name:"DeleteCustomerDialog",props:["visible"],setup(S){const{visible:f}=S,{currentCustomer:c}=B(k()),{deleteCustomer:$}=k(),x=X(),v=i(f),P=async()=>{const d=await $(c.value);v.value=!1,d!=null&&d.result=="ok"?x.add({severity:"success",summary:"Success",detail:"Delete Customer Successfully!",group:"bl",life:3e3}):x.add({severity:"danger",summary:"Error",detail:"Failed to Delete Customer",group:"bl",life:3e3})};return(d,m)=>{const g=R,p=G;return C(),h(p,{visible:t(v),"onUpdate:visible":m[1]||(m[1]=r=>w(v)?v.value=r:null),modal:"",maximizable:"",header:"Header",style:{width:"50rem"},breakpoints:{"1199px":"75vw","575px":"90vw"}},{header:n(()=>[Ae]),footer:n(()=>[o(g,{type:"button",label:"Cancel",text:"",severity:"secondary",onClick:m[0]||(m[0]=r=>v.value=!1)}),o(g,{type:"submit",label:"Yes, delete",severity:"danger",onClick:P})]),default:n(()=>[e("div",null,[e("span",null,[O(" This will delete customer "),e("b",null,A(`${t(c).first_name} ${t(c).last_name}`),1),O(" permanently! ")]),Be])]),_:1},8,["visible"])}}},ze={class:"w-full h-full flex flex-col"},Le={class:"fixed right-0 top-0 z-50 backdrop-blur-xl w-5/6 h-[8%] px-4 border-b flex justify-between items-center"},He={class:"flex items-center gap-2"},Oe=e("span",{class:"font-semibold text-lg"},"Customers",-1),Re={class:"flex items-center gap-2"},Ye={class:"fixed right-0 top-[8%] z-50 backdrop-blur-xl w-5/6 h-[8%] px-4 border-b flex justify-between items-center"},qe={class:"flex items-center gap-2"},Ge=e("label",{for:"currentProject",class:"font-semibold text-lg"},"Current Project: ",-1),Xe={class:"absolute top-[16%] w-full h-[92%]"},Je=e("div",{class:"flex justify-center items-center"},[e("span",null,"No Customers Found.")],-1),Ke={class:"flex items-center gap-3"},Qe={class:"flex flex-col"},We={class:"font-semibold"},zt={__name:"index",async setup(S){var j,F;let f,c;const{customers:$,currentCustomer:x}=B(k()),{getCustomers:v}=k(),{projects:P,projectsDropdown:d}=B(E()),{getProjects:m}=E();[f,c]=H(()=>v()),await f,c(),[f,c]=H(()=>m()),await f,c();const g=i({name:((j=d.value[0])==null?void 0:j.name)??"",value:((F=d.value[0])==null?void 0:F.value)??""}),p=ve(()=>$.value.filter(l=>l.project_id==g.value.value));i([{name:"Anonymous",value:"anonymous"},{name:"Sale",value:"sale"},{name:"Sale Manager",value:"sale_manager"},{name:"Admin",value:"admin"},{name:"Super Admin",value:"super_admin"}]);const r=i({global:{value:null,matchMode:Ce.CONTAINS}}),_=i(!1),b=i(!1),y=i(!1),D=i(!1),I=l=>{p.value=$.value.filter(u=>u.project_id==l.value)},s=l=>{x.value=l,_.value=!_.value},V=l=>{x.value=l,y.value=!y.value},z=async l=>{x.value=l,D.value=!D.value};return(l,u)=>{const J=ie,M=re,K=me,Q=Y,W=ue,T=R,Z=q,ee=ce,L=de,te=pe,oe=_e,le=Ue,se=fe,ae=Ee,ne=ye("auto-animate");return C(),be(ge,null,[e("div",ze,[e("div",Le,[e("div",He,[Oe,o(J,{value:t(p).length},null,8,["value"])]),e("div",Re,[o(W,{iconPosition:"left"},{default:n(()=>[o(K,{class:"flex items-center"},{default:n(()=>[o(M,{name:"mdi:filter-outline"})]),_:1}),o(Q,{modelValue:t(r).global.value,"onUpdate:modelValue":u[0]||(u[0]=a=>t(r).global.value=a),placeholder:"Filter Customer..."},null,8,["modelValue"])]),_:1}),o(T,{size:"small",label:"New",onClick:u[1]||(u[1]=a=>b.value=!t(b))})])]),e("div",Ye,[e("div",qe,[Ge,o(Z,{id:"currentProject",placeholder:"Select Project",modelValue:t(g).value,"onUpdate:modelValue":u[2]||(u[2]=a=>t(g).value=a),options:t(d),optionLabel:"name",optionValue:"value",onChange:u[3]||(u[3]=a=>I(a))},null,8,["modelValue","options"])])]),e("div",Xe,[xe((C(),h(te,{value:t(p),filters:t(r),"onUpdate:filters":u[4]||(u[4]=a=>w(r)?r.value=a:null),paginator:!0,rows:50,rowsPerPageOptions:[5,10,20,50],scrollable:"",scrollHeight:"flex",removableSort:""},{empty:n(()=>[Je]),default:n(()=>[o(L,{field:"fullname",header:"Full Name"},{body:n(({data:a})=>{var N;return[e("div",Ke,[o(ee,{label:(N=a.first_name)==null?void 0:N.substring(0,3),shape:"square"},null,8,["label"]),e("div",Qe,[e("span",We,A(`${a.first_name} ${a.last_name}`),1),e("span",null,A(a.email),1)])])]}),_:1}),o(L,{field:"phone",header:"Phone",sortable:""},{body:n(({data:a})=>[O(A(a.phone),1)]),_:1}),o(L,{header:"Actions"},{body:n(({data:a})=>[o(T,{text:"",severity:"secondary",onClick:N=>s(a)},{default:n(()=>[o(M,{name:"mdi:eye-outline"})]),_:2},1032,["onClick"]),o(T,{text:"",severity:"secondary",onClick:N=>V(a)},{default:n(()=>[o(M,{name:"mdi:edit-outline"})]),_:2},1032,["onClick"]),o(T,{text:"",severity:"danger",onClick:N=>z(a)},{default:n(()=>[o(M,{name:"mdi:delete-outline"})]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["value","filters"])),[[ne]])])]),t(_)?(C(),h(oe,{key:0,visible:t(_)},null,8,["visible"])):U("",!0),t(b)?(C(),h(le,{key:1,visible:t(b)},null,8,["visible"])):U("",!0),t(y)?(C(),h(se,{key:2,visible:t(y)},null,8,["visible"])):U("",!0),t(D)?(C(),h(ae,{key:3,visible:t(D)},null,8,["visible"])):U("",!0)],64)}}};export{zt as default};
